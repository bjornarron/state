k=length(Merker)
inferens_df <- data.frame(merke=Merker,
n = rep(0,k),
Sx = rep(0,k),
Sxx = rep(0,k)
)
for (merke in Merker) {
m = which(Merker==merke)
temp_df = filter(seigmann_df,Merke==merke)
temp2_df = filter(temp_df,Type=="Raw")
for (path in temp2_df$Path) {
this_df = read.csv(paste("3a_nye/",path,sep=""))
n=dim(this_df)[1]
Sx=sum(this_df[,1])
Sxx=sum(this_df[,1]^2)
Sxx = Sxx + 0.5^2/12  # Fordi nøyaktighet på 5mm
inferens_df$n[m] = inferens_df$n[m] + n
inferens_df$Sx[m] = inferens_df$Sx[m] + Sx
inferens_df$Sxx[m] = inferens_df$Sxx[m] + Sxx
}
temp3_df = filter(temp_df,Type=="Table")
for (path in temp3_df$Path) {
this_df = read.csv(paste("3a_nye/",path,sep=""))
n=sum(this_df$Antall)
Sx=sum(this_df$Antall*this_df$Midtpunkt)
Sxx=sum(this_df$Antall*this_df$Midtpunkt^2)
SxB=sum(this_df$Antall*this_df$Bredde^2)/12
Sxx = Sxx + SxB
inferens_df$n[m] = inferens_df$n[m] + n
inferens_df$Sx[m] = inferens_df$Sx[m] + Sx
inferens_df$Sxx[m] = inferens_df$Sxx[m] + Sxx
}
}
inferens_df
# Nå har dere alt dere trenger for å utføre inferensen.
# Alle dataene er lest inn og oppsummert!
library(datasets)
discoveries
#Histogram
k=5
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[0:2])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[0:24])
t=25
k2=k0+n
tau2=tau0+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries)
t=100
k3=k0+n
tau3=tau0+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
plot(x,y1, type='l',col="maroon", ylim = c(0,5))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[0:24])
n
#Neste 22 år. Totalt 25 år
n=sum(discoveries[0:25])
n
install.packages("rmutil")
install.packages("extraDistr")
dbbinom(x,n,a,b)
library(extraDistr)
dbbinom(x,n,a,b)
library(gridExtra)
detach("package:gridExtra", unload = TRUE)
detach("package:extraDistr", unload = TRUE)
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:100])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:100])
#Neste 22 år. Totalt 25 år
n=sum(discoveries[3:24])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:120])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:101])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:100])
n=sum(discoveries[1:3])
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[25:100])
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
discoveries
bæsj=discoveries
n=sum(discoveries[1:4])
library(datasets)
bæsj=discoveries
#Histogram
k=5
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
plot(x,y1, type='l',col="maroon", ylim = c(0,5))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
library(datasets)
bæsj=discoveries
#Histogram
k=5
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
plot(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
plot(x,y1, type='l',col="maroon", ylim = c(0,3), xlim = c(0.5,5))
library(datasets)
bæsj=discoveries
#Histogram
k=5
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
plot(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
library(datasets)
bæsj=discoveries
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
plot(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
library(datasets)
bæsj=discoveries
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
library(datasets)
bæsj=discoveries
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,2))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
bæsj
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = FALSE, ylim = c(0,2))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = FALSE, ylim = c(0,15))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
library(datasets)
bæsj=discoveries
bæsj
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,2))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
dpois(X, lambda)
X = 5
dpois(X, lambda)
lambda=k3/t3
X = 5
dpois(X, lambda)
lambda=k3/t3
lambda=k3/tau3
X = 5
dpois(X, lambda)
X = 3
dpois(X, lambda)
X = 2
dpois(X, lambda)
X = 2.6
dpois(X, lambda)
X = 6
dpois(X, lambda)
X = 0
dpois(X, lambda)
X = 5
dpois(X, lambda)
dpois(X, lambda)*100
library(datasets)
bæsj=discoveries
bæsj
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,2))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
# Finne P(X=5)
lambda=k3/tau3
X = 3
dpois(X, lambda)*100
print("P (X = 5) er "dpois(X, lambda)*100 )
print(f"P (X = 5) er "dpois(X, lambda)*100 )
print("P (X = 5) er ")dpois(X, lambda)*100
print("P (X = 5) er " dpois(X, lambda)*100 "")
paste("P (X = 5) er " dpois(X, lambda)*100)
paste("P (X = 5) er ", dpois(X, lambda)*100)
X = 5
paste("P (X = 5) er ", dpois(X, lambda)*100)
paste("P (X = 5) er ", dpois(X, lambda))
# Finne P(X=5)
lambda1= dgamma(5.k3,tau3)
# Finne P(X=5)
lambda1= dgamma(5,k3,tau3)
dnbinom(X,k3,tau3/(tau3-X))
dnbinom(5,k3,tau3/(tau3-X))
dnbinom(100,k3,tau3/(tau3-X))
tau3/(tau3-X)
dnbinom(5,k3,tau3/(tau3-X))
k3=k2+n
dnbinom(5,k3,1)
dnbinom(5,k3,2)
dnbinom(5,k3,0.2)
dnbinom(5,k3,tau3/(tau3+X))
dnbinom(5,k3,tau3/(tau3+2))
dnbinom(5,k3,tau3/(tau3+2))*100
print("P (X=5) over to år vil dæ være ", dnbinom(5,k3,tau3/(tau3+2))*100)
print("P (X=5) over to år vil dæ være ", dnbinom(5,k3,tau3/(tau3+2))*100)
paste("P (X=5) over to år vil dæ være ", dnbinom(5,k3,tau3/(tau3+2))*100)
library(datasets)
bæsj=discoveries
bæsj
#Histogram
k=12
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,1))
k0=0
tau0=0
#Etter 3 år
t=3
n=sum(discoveries[1:3])
k1=k0+n
tau1=tau0+t
x=seq(0,5,0.001)
y1=dgamma(x, k1, tau1)
plot(x,y1, type='l',col="maroon")
#Neste 22 år. Totalt 25 år
n=sum(discoveries[4:25])
t=22
k2=k1+n
tau2=tau1+t
y2=dgamma(x, k2, tau2)
plot(x,y2, type='l',col="blue")
#Neste 75 år. Totalt 100 år
n=sum(discoveries[26:100])
t=75
k3=k2+n
tau3=tau2+t
y3=dgamma(x, k3, tau3)
plot(x,y3, type='l',col="pink")
hist(discoveries,breaks=k,ylab = "Hvor mange år som hadde den oppdagelsesraten",
xlab = "antall oppdagelser i året", probability = TRUE, ylim = c(0,2))
lines(x,y1, type='l',col="maroon", ylim = c(0,3))
lines(x,y2, type='l',col="blue")
lines(x,y3, type='l',col="pink")
# Finne P(X=5)
X = 2
tau3/(tau3-X)
dnbinom(5,k3,tau3/(tau3+2))*100
paste("P (X=5) over to år vil dæ være ", round(dnbinom(5,k3,tau3/(tau3+2))*100)
paste("P (X=5) over to år vil dæ være ", round(dnbinom(5,k3,tau3/(tau3+2))*100))
paste("P (X=5) over to år vil dæ være ", round(dnbinom(5,k3,tau3/(tau3+2)*100)
paste("P (X=5) over to år vil dæ være ", round(dnbinom(5,k3,tau3/(tau3+2)*100))
round(dnbinom(5,k3,tau3/(tau3+2))*100)
round(dnbinom(5,k3,tau3/(tau3+2))*100, 2)
round(dnbinom(5,k3,tau3/(tau3+2))*100, 4)
P(X=5) = round(dnbinom(5,k3,tau3/(tau3+2))*100, 4)
paste("P (X=5) over to år vil dæ være ", x10, "%")
paste("P (X=5) over to år vil dæ være ", x10, "%")
x10 = round(dnbinom(5,k3,tau3/(tau3+2))*100, 4)
paste("P (X=5) over to år vil dæ være ", x10, "%")
